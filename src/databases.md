# Databases

## ACID

- Atomic
- Consistent
- Isolated
- Durable

## Atomicity

An atomic transaction is an indivisible and irreducible series of database operations such that either all occurs, or nothing occurs.

## Consistency

Any data written to the database must be valid according to all defined rules, including constraints, cascades, triggers, and any combination thereof.

## Isolation

The ability of a database to allow a transaction to execute as if there are no other concurrently running transactions.

## Durability

Guarantees that transactions that have committed will survive permanently.

## Difference between left join and right join

The left (outer) join includes all records from the left side and matched rows from the right table.

The right (outer) join includes all records from the right side and matched rows from the left table.

## Cross join

Returns the Cartesian product of rows from the tables in the join.

Multiplication of both tables.

Does not require any condition to join tables.

## Full join

Returns all the rows from both joined tables, whether they have a matching row or not.

Combines a left outer join and a right outer join.

## Inner join

Returns only the rows that have matching values in both tables.

## Cursor

Enables traversal over the records in a database.

Cursors are a way of processing a table or result set row by row.

## Non-clustered index

Index which does not define the physical order in which table records are stored in a database.

## Clustered index

Index which defines the physical order in which table records are stored in a database.

## Index hunting

The process of boosting the collection of indexes which help in improving the query performance as well as the speed of the database.

## View

Virtual table based on the result-set of an SQL statement.

## Difference between view and materialized view

Views are virtual only and run the query definition each time they are accessed.

Materialized views are disk based and are updated periodically based upon the query definition.

## Normalization

Process of structuring a relational database in accordance with a series of so-called normal forms in order to reduce data redundancy and improve data integrity.

## PostgreSQL: CTE

Common table expression.

```postgresql
WITH cte_film AS (SELECT id,
                         title
                  FROM film)
SELECT id,
       title
FROM cte_film
```

## PostgreSQL: CASE

```postgresql
SELECT CASE
           WHEN length > 0 AND length <= 50 THEN 'Short'
           WHEN length > 50 AND length <= 120 THEN 'Medium'
           WHEN length > 120 THEN 'Long'
           END duration
FROM film
```

## PostgreSQL: FILTER

```postgresql
SELECT count(*)                      AS unfiltered,
       count(*) FILTER (WHERE i < 5) AS filtered
FROM generate_series(1, 10) AS s(i);
```

## PostgreSQL: LIMIT

Used to get a subset of rows generated by a query.

```postgresql
SELECT *
FROM film
LIMIT 10;
```

## PostgreSQL: OFFSET

Used to skip a number of rows generated by a query.

```postgresql
SELECT *
FROM film
LIMIT 10 OFFSET 5;
```

## PostgreSQL: define a new table from the results of a query

SELECT INTO

```postgresql
SELECT *
INTO films_recent
FROM films
WHERE released_at >= '2002-01-01';
```

## PostgreSQL: it is for columns what a view is for tables

Generated columns.

## PostgreSQL: two kinds of generated columns

- Virtual
- Stored

## PostgreSQL: create an array

```postgresql
SELECT ARRAY[1, 2, 3];
```

## PostgreSQL: convert an array to a string

```postgresql
SELECT ARRAY_TO_STRING(ARRAY[1, 2, 3], ',');
```

## Page

A page is a unit of data storage in a database management system.

## Manages transaction concurrency

Locking.

## PostgreSQL: types of locks

- Table-level
- Row-Level
- Page-level
- Advisory
- Deadlock

## Table-level lock

Locks the entire table.

## Row-level lock

Locks a single row.

## Page-level lock

Locks a single page.

## Advisory lock

Arbitrary lock, can be acquired by any process and lock any resource.

## Deadlock

A situation in which two or more transactions are waiting for one another to give up locks.

## Constraint

A constraint is a rule that is enforced on a table or view.

## Cascade

Used to simultaneously delete or update an entry from both the child and parent table.

## Trigger

Procedural code that is automatically executed in response to certain events on a particular table or view in a database.

## Row-security

Row-security is a security feature which allows users to give access to a sub-set of data in their table to others.
